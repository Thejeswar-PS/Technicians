<div class="container-fluid jobs-to-be-uploaded-container">
  <div class="card shadow-sm main-card">
    <div class="card-header border-0 py-4">
      <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
        <button type="button" class="btn btn-sm btn-primary" (click)="goBack()" [disabled]="isLoading">
          <i class="bi bi-arrow-left me-2"></i>Back
        </button>
        <div class="text-center flex-grow-1">
          <h3 class="fw-bold text-primary text-light mb-0">Jobs To Be Uploaded</h3>
        </div>
        <div></div>
      </div>
    </div>

    <div class="card-body">
      <!-- Status Message -->
      <div class="mb-4" *ngIf="statusMessage">
        <div [ngClass]="isError ? 'alert alert-danger' : 'alert alert-success'" 
             class="d-inline-flex align-items-center" role="alert">
          <i [ngClass]="isError ? 'bi bi-exclamation-triangle-fill' : 'bi bi-check-circle-fill'" 
             class="me-2"></i>
          <span>{{ statusMessage }}</span>
        </div>
      </div>

      <!-- Filter Panel -->
      <div class="row mb-4 filter-panel">
        <div class="col-md-3">
          <label class="form-label fw-bold">Technician:</label>
          <select 
            class="form-select" 
            [(ngModel)]="selectedTechnician"
            [disabled]="isLoading">
            <option value="All">All</option>
            <option *ngFor="let tech of technicians" [value]="tech.techID">
              {{ tech.techName }}
            </option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label fw-bold">Account Manager:</label>
          <select 
            class="form-select" 
            [(ngModel)]="selectedAccountManager"
            [disabled]="isLoading || accountManagerDisabled">
            <option value="All">All</option>
            <option *ngFor="let am of accountManagers" [value]="am.empID">
              {{ am.empName }}
            </option>
          </select>
        </div>

        <div class="col-md-2 d-flex align-items-end">
          <button 
            type="button" 
            class="btn btn-primary w-100"
            (click)="getJobs()"
            [disabled]="isLoading">
            <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
            {{ isLoading ? 'Loading...' : 'Get Jobs' }}
          </button>
        </div>
      </div>

      <!-- Jobs Grid -->
      <div class="table-responsive" *ngIf="jobs.length > 0">
        <table class="table table-hover table-bordered">
          <thead class="table-light">
            <tr>
              <th class="fw-bold">Call No</th>
              <th class="fw-bold">Technician</th>
              <th class="fw-bold">Manager</th>
              <th class="fw-bold">Status</th>
              <th class="fw-bold">Started On</th>
              <th class="fw-bold">Customer Name</th>
              <th class="fw-bold">Age</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let job of jobs" [style.cursor]="'pointer'" 
                (click)="goToJobDetails(job.callNbr)"
                class="job-row">
              <td>
                <a href="javascript:void(0)" class="text-primary text-decoration-none">
                  {{ job.callNbr }}
                </a>
              </td>
              <td>{{ job.techName }}</td>
              <td>{{ job.accMgr }}</td>
              <td>
                <span [ngClass]="'badge bg-info'">
                  {{ job.status }}
                </span>
              </td>
              <td>{{ job.strtDate | date: 'dd-MMM-yyyy' }}</td>
              <td>{{ job.custName }}</td>
              <td>{{ job.changeAge }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Empty State -->
      <div class="alert alert-info text-center" *ngIf="!isLoading && jobs.length === 0 && statusMessage">
        <i class="bi bi-info-circle me-2"></i>
        No records to display
      </div>
    </div>
  </div>
</div>
