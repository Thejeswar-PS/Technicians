<div class="container-fluid acc-mgr-performance-container">
  <!-- Loading Overlay -->
  <div *ngIf="isLoading" class="position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center" style="background: rgba(0,0,0,0.3); z-index: 9999;">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <!-- Page Title -->
  <div class="text-center mb-4">
    <h2 class="fw-bold text-primary mb-02 display-4.9">Account Manager Performance Report</h2>
  </div>

  <div class="card shadow-sm main-card">
    <div class="card-body">
      <!-- Message -->
      <div class="mb-4" *ngIf="errorMessage">
        <div class="alert alert-danger d-inline-flex align-items-center" role="alert">
          <i class="bi bi-exclamation-triangle-fill me-2"></i>
          <span>{{ errorMessage }}</span>
        </div>
      </div>

      <!-- Filters -->
      <form [formGroup]="reportForm" class="row mb-4 filter-panel">
        <div class="col-md-6">
          <label class="form-label fw-bold">Office/Account Manager:</label>
          <select 
            class="form-select"
            formControlName="officeId"
            [class.is-invalid]="hasError('officeId')"
            [disabled]="isLoadingAccountManagers"
            (change)="onOfficeChange()">
            <option value="" disabled>
              {{ isLoadingAccountManagers ? 'Loading account managers...' : 'Select Office/Account Manager' }}
            </option>
            <option 
              *ngFor="let manager of accountManagers" 
              [value]="manager.OFFID || manager.empId">
              {{ manager.OFFNAME || manager.empName }} ({{ manager.OFFID || manager.empId }})
            </option>
          </select>
          <div class="invalid-feedback" *ngIf="hasError('officeId')">
            {{ getErrorMessage('officeId') }}
          </div>
        </div>
        <div class="col-md-6 d-flex align-items-end gap-2">
          <button 
            class="btn btn-primary flex-grow-1" 
            (click)="generateReport()" 
            [disabled]="isLoading || isLoadingAccountManagers">
            <i class="bi bi-bar-chart me-2"></i>{{ reportData ? 'Refresh Report' : 'Generate Report' }}
          </button>
          <button 
            class="btn btn-warning" 
            (click)="generateReport('RedOrange')" 
            [disabled]="isLoading || isLoadingAccountManagers">
            <i class="bi bi-filter me-2"></i>Critical Jobs
          </button>
          <button class="btn btn-secondary" (click)="clearReport()" *ngIf="reportData" [disabled]="isLoading">
            <i class="bi bi-arrow-clockwise"></i>
          </button>
        </div>
      </form>

      <!-- Navigation Tabs -->
      <div class="mb-4" *ngIf="reportData">
        <nav>
          <div class="nav nav-pills justify-content-center flex-wrap section-tabs" id="nav-tab" role="tablist">
            <button class="nav-link" 
                    [class.active]="activeSection === 'completedNotReturned'"
                    (click)="setActiveSection('completedNotReturned')"
                    type="button">
              <i class="bi bi-exclamation-triangle me-2"></i>
              Completed Not Returned
              <span class="badge bg-danger ms-2">{{ (reportData.CompletedNotReturned || reportData.completedNotReturned || []).length }}</span>
            </button>
            <button class="nav-link" 
                    [class.active]="activeSection === 'returnedForProcessing'"
                    (click)="setActiveSection('returnedForProcessing')"
                    type="button">
              <i class="bi bi-arrow-clockwise me-2"></i>
              Returned for Processing
              <span class="badge bg-warning ms-2">{{ (reportData.ReturnedForProcessing || reportData.returnedForProcessing || []).length }}</span>
            </button>
            <button class="nav-link" 
                    [class.active]="activeSection === 'jobsScheduledToday'"
                    (click)="setActiveSection('jobsScheduledToday')"
                    type="button">
              <i class="bi bi-calendar-day me-2"></i>
              Scheduled Today
              <span class="badge bg-info ms-2">{{ reportData.jobsScheduledToday.length }}</span>
            </button>
            <button class="nav-link" 
                    [class.active]="activeSection === 'returnedWithIncompleteData'"
                    (click)="setActiveSection('returnedWithIncompleteData')"
                    type="button">
              <i class="bi bi-exclamation-circle me-2"></i>
              Incomplete Data
              <span class="badge bg-warning ms-2">{{ reportData.returnedWithIncompleteData.length }}</span>
            </button>
            <button class="nav-link" 
                    [class.active]="activeSection === 'jobsConfirmedNext120Hours'"
                    (click)="setActiveSection('jobsConfirmedNext120Hours')"
                    type="button">
              <i class="bi bi-clock me-2"></i>
              Confirmed Next 120H
              <span class="badge bg-success ms-2">{{ reportData.jobsConfirmedNext120Hours.length }}</span>
            </button>
            <button class="nav-link" 
                    [class.active]="activeSection === 'pastDueUnscheduled'"
                    (click)="setActiveSection('pastDueUnscheduled')"
                    type="button">
              <i class="bi bi-calendar-x me-2"></i>
              Past Due
              <span class="badge bg-danger ms-2">{{ (reportData.PastDueUnscheduled || reportData.pastDueUnscheduled || []).length }}</span>
            </button>
            <button class="nav-link" 
                    [class.active]="activeSection === 'firstMonth'"
                    (click)="setActiveSection('firstMonth')"
                    type="button">
              <i class="bi bi-calendar me-2"></i>
              {{ monthLabels[0] || 'Current Month' }}
              <span class="badge bg-info ms-2">{{ (reportData.FirstMonth || reportData.firstMonth || []).length }}</span>
            </button>
            <button class="nav-link" 
                    [class.active]="activeSection === 'secondMonth'"
                    (click)="setActiveSection('secondMonth')"
                    type="button">
              <i class="bi bi-calendar me-2"></i>
              {{ monthLabels[1] || 'Next Month' }}
              <span class="badge bg-info ms-2">{{ (reportData.SecondMonth || reportData.secondMonth || []).length }}</span>
            </button>
            <button class="nav-link" 
                    [class.active]="activeSection === 'thirdMonth'"
                    (click)="setActiveSection('thirdMonth')"
                    type="button">
              <i class="bi bi-calendar me-2"></i>
              {{ monthLabels[2] || 'Month 3' }}
              <span class="badge bg-info ms-2">{{ (reportData.ThirdMonth || reportData.thirdMonth || []).length }}</span>
            </button>
            <button class="nav-link" 
                    [class.active]="activeSection === 'fourthMonth'"
                    (click)="setActiveSection('fourthMonth')"
                    type="button">
              <i class="bi bi-calendar me-2"></i>
              {{ monthLabels[3] || 'Month 4' }}
              <span class="badge bg-info ms-2">{{ (reportData.FourthMonth || reportData.fourthMonth || []).length }}</span>
            </button>
            <button class="nav-link" 
                    [class.active]="activeSection === 'fifthMonth'"
                    (click)="setActiveSection('fifthMonth')"
                    type="button">
              <i class="bi bi-calendar me-2"></i>
              {{ monthLabels[4] || 'Month 5' }}
              <span class="badge bg-info ms-2">{{ (reportData.FifthMonth || reportData.fifthMonth || []).length }}</span>
            </button>
          </div>
        </nav>
      </div>

      <!-- Records Per Page -->
      <div class="d-flex align-items-center justify-content-between mb-3" *ngIf="reportData && getActiveData().length > 0">
        <div class="d-flex align-items-center">
          <label class="me-2 fw-semibold">Records per page:</label>
          <select class="form-select form-select-sm w-auto"
                  [(ngModel)]="itemsPerPage"
                  (change)="currentPage = 1">
            <option value="10">10</option>
            <option value="25">25</option>
            <option value="50">50</option>
            <option value="100" selected>100</option>
          </select>
        </div>

        <div class="flex-fill text-center fw-semibold">
          Showing
          {{ totalItems ? ((currentPage - 1) * itemsPerPage + 1) : 0 }}
          -
          {{ totalItems ? Math.min(currentPage * itemsPerPage, totalItems) : 0 }}
          of {{ totalItems }} records
        </div>

        <div class="d-flex align-items-center gap-2">
          <button type="button"
                  class="btn btn-sm btn-outline-secondary"
                  (click)="goToPage(currentPage - 1)"
                  [disabled]="currentPage <= 1">
            Prev
          </button>
          <span class="fw-semibold">Page {{ currentPage }} of {{ getTotalPages() }}</span>
          <button type="button"
                  class="btn btn-sm btn-outline-secondary"
                  (click)="goToPage(currentPage + 1)"
                  [disabled]="currentPage >= getTotalPages()">
            Next
          </button>
        </div>
      </div>

      <!-- Table Content -->
      <div class="table-responsive" *ngIf="reportData && getActiveData().length > 0">
        <!-- Completed Not Returned -->
        <div *ngIf="activeSection === 'completedNotReturned'">
          <h5 class="mb-3"><i class="bi bi-exclamation-triangle text-danger me-2"></i>Completed Jobs Not Returned from Technician</h5>
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Call Number</th>
                <th class="fw-bold">Customer ID</th>
                <th class="fw-bold">Customer Name</th>
                <th class="fw-bold">Status</th>
                <th class="fw-bold">Technician</th>
                <th class="fw-bold">Job Completion Date</th>
                <th class="fw-bold">Days Tech Holding</th>
                <th class="fw-bold">Description</th>
                <th class="fw-bold">Contract No</th>
                <th class="fw-bold">Quoted Amount</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of getPaginatedData()" 
                  [ngClass]="getRowColorClass(item, 'completedNotReturned')">
                <td class="fw-bold">{{ item.callNbr }}</td>
                <td>{{ item.custNmbr }}</td>
                <td>{{ item.custName }}</td>
                <td>
                  <span class="badge" 
                        [ngClass]="getStatusBadgeClass(item, 'completedNotReturned')"
                        [class.fw-bold]="getStatusText(item) === 'Bill After PM'">
                    {{ getStatusText(item) }}
                  </span>
                </td>
                <td>{{ item.techName }}</td>
                <td>{{ formatDate(item.scheduledEnd) }}</td>
                <td [class.fw-bold]="shouldBoldAge(item)">{{ item.changeAge }}</td>
                <td>{{ item.description }}</td>
                <td>{{ getContractNumber(item) }}</td>
                <td [class.fw-bold]="shouldBoldAmount(item)" [class.text-primary]="shouldBoldAmount(item)">{{ formatCurrency(getQuotedAmount(item)) }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Returned for Processing -->
        <div *ngIf="activeSection === 'returnedForProcessing'">
          <h5 class="mb-3"><i class="bi bi-arrow-clockwise text-warning me-2"></i>Jobs Returned from Technician for Processing</h5>
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Call Number</th>
                <th class="fw-bold">Customer ID</th>
                <th class="fw-bold">Customer Name</th>
                <th class="fw-bold">Status</th>
                <th class="fw-bold">Technician</th>
                <th class="fw-bold">Job Scheduled On</th>
                <th class="fw-bold">Job Returned On</th>
                <th class="fw-bold">Days Acc Mgr Holding</th>
                <th class="fw-bold">Description</th>
                <th class="fw-bold">Contract No</th>
                <th class="fw-bold">Quoted Amount</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of getPaginatedData()"
                  [ngClass]="getRowColorClass(item, 'returnedForProcessing')">
                <td class="fw-bold">{{ item.callNbr }}</td>
                <td>{{ item.custNmbr }}</td>
                <td>{{ item.custName }}</td>
                <td>
                  <span class="badge" 
                        [ngClass]="getStatusBadgeClass(item, 'returnedForProcessing')"
                        [class.fw-bold]="getStatusText(item) === 'Bill After PM'">
                    {{ getStatusText(item) }}
                  </span>
                </td>
                <td>{{ item.techName }}</td>
                <td>{{ formatDate(item.scheduledStart) }}</td>
                <td>{{ formatDate(item.returned || item.responseDate) }}</td>
                <td [class.fw-bold]="shouldBoldAge(item)">{{ item.changeAge1 ?? item.changeAge }}</td>
                <td>{{ item.description }}</td>
                <td>{{ getContractNumber(item) }}</td>
                <td [class.fw-bold]="shouldBoldAmount(item)" [class.text-primary]="shouldBoldAmount(item)">{{ formatCurrency(getQuotedAmount(item)) }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Jobs Scheduled Today -->
        <div *ngIf="activeSection === 'jobsScheduledToday'">
          <h5 class="mb-3"><i class="bi bi-calendar-day text-info me-2"></i>Jobs Scheduled Today</h5>
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Call Number</th>
                <th class="fw-bold">Customer</th>
                <th class="fw-bold">Job Status</th>
                <th class="fw-bold">Scheduled Start</th>
                <th class="fw-bold">Scheduled End</th>
                <th class="fw-bold">Tech Name</th>
                <th class="fw-bold">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of getPaginatedData()">
                <td class="fw-bold">{{ item.callNbr }}</td>
                <td>{{ item.custName }}</td>
                <td><span class="badge" [ngClass]="getStatusBadgeClass(item, 'jobsScheduledToday')">{{ item.jobStatus }}</span></td>
                <td>{{ formatDate(item.scheduledStart) }}</td>
                <td>{{ formatDate(item.scheduledEnd) }}</td>
                <td>{{ item.techName }}</td>
                <td>{{ item.description }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Returned with Incomplete Data -->
        <div *ngIf="activeSection === 'returnedWithIncompleteData'">
          <h5 class="mb-3"><i class="bi bi-exclamation-circle text-warning me-2"></i>Returned with Incomplete Data</h5>
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Call Number</th>
                <th class="fw-bold">Customer ID</th>
                <th class="fw-bold">Customer Name</th>
                <th class="fw-bold">Status</th>
                <th class="fw-bold">Technician</th>
                <th class="fw-bold">Job Completion Date</th>
                <th class="fw-bold">Days Tech Holding</th>
                <th class="fw-bold">Description</th>
                <th class="fw-bold">Contract No</th>
                <th class="fw-bold">Quoted Amount</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of getPaginatedData()"
                  [ngClass]="getRowColorClass(item, 'returnedWithIncompleteData')">
                <td class="fw-bold">{{ item.callNbr }}</td>
                <td>{{ item.custNmbr }}</td>
                <td>{{ item.custName }}</td>
                <td>
                  <span class="badge" 
                        [ngClass]="getStatusBadgeClass(item, 'returnedWithIncompleteData')"
                        [class.fw-bold]="getStatusText(item) === 'Bill After PM'">
                    {{ getStatusText(item) }}
                  </span>
                </td>
                <td>{{ item.techName }}</td>
                <td>{{ formatDate(item.responseDate) }}</td>
                <td [class.fw-bold]="shouldBoldAge(item)">{{ item.changeAge }}</td>
                <td>{{ item.description }}</td>
                <td>{{ getContractNumber(item) }}</td>
                <td [class.fw-bold]="shouldBoldAmount(item)" [class.text-primary]="shouldBoldAmount(item)">{{ formatCurrency(getQuotedAmount(item)) }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Customer Confirmed Next 120 Hours -->
        <div *ngIf="activeSection === 'jobsConfirmedNext120Hours'">
          <h5 class="mb-3"><i class="bi bi-clock text-success me-2"></i>Customer Confirmed Next 120 Hours</h5>
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Call Number</th>
                <th class="fw-bold">Scheduled Date</th>
                <th class="fw-bold">Customer Name</th>
                <th class="fw-bold">Technician Assigned</th>
                <th class="fw-bold">Call Type</th>
                <th class="fw-bold">Confirmation Status</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of getPaginatedData()">
                <td class="fw-bold">{{ item.callNbr }}</td>
                <td>{{ formatDate(item.scheduledStart) }}</td>
                <td>{{ item.custName }}</td>
                <td>{{ item.techName }}</td>
                <td>{{ item.jobType }}</td>
                <td><span class="badge bg-success">Confirmed</span></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Past Due Unscheduled -->
        <div *ngIf="activeSection === 'pastDueUnscheduled'">
          <h5 class="mb-3"><i class="bi bi-calendar-x text-danger me-2"></i>Past Due Unscheduled Jobs</h5>
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Call Number</th>
                <th class="fw-bold">Customer ID</th>
                <th class="fw-bold">Customer Name</th>
                <th class="fw-bold">Status</th>
                <th class="fw-bold">Site Contact</th>
                <th class="fw-bold">City</th>
                <th class="fw-bold">Job Due On</th>
                <th class="fw-bold">No Of Days</th>
                <th class="fw-bold">Original Age</th>
                <th class="fw-bold">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of getPaginatedData()">
                <td class="fw-bold">{{ item.callNbr }}</td>
                <td>{{ item.custNmbr }}</td>
                <td>{{ item.custName }}</td>
                <td><span class="badge" [ngClass]="getStatusBadgeClass(item, 'pastDueUnscheduled')">{{ item.jobStatus }}</span></td>
                <td>{{ item.siteContact }}</td>
                <td>{{ item.city }}</td>
                <td>{{ formatDate(item.scheduledStart) }}</td>
                <td>{{ item.changeAge }}</td>
                <td>{{ item.origAge }}</td>
                <td>{{ item.description }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Monthly Unscheduled Jobs (Current Month) -->
        <div *ngIf="activeSection === 'firstMonth'">
          <h5 class="mb-3"><i class="bi bi-calendar text-info me-2"></i>{{ monthLabels[0] || 'Current Month' }} Unscheduled Jobs</h5>
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Call Number</th>
                <th class="fw-bold">Customer ID</th>
                <th class="fw-bold">Customer Name</th>
                <th class="fw-bold">Status</th>
                <th class="fw-bold">Site Contact</th>
                <th class="fw-bold">City</th>
                <th class="fw-bold">Job Due On</th>
                <th class="fw-bold">Current Age</th>
                <th class="fw-bold">Original Age</th>
                <th class="fw-bold">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of getPaginatedData()"
                  [ngClass]="getRowColorClass(item, 'firstMonth')">
                <td class="fw-bold">{{ item.callNbr }}</td>
                <td>{{ item.custNmbr }}</td>
                <td>{{ item.custName }}</td>
                <td><span class="badge" [ngClass]="getStatusBadgeClass(item, 'firstMonth')">{{ item.jobStatus }}</span></td>
                <td>{{ item.siteContact }}</td>
                <td>{{ item.city }}</td>
                <td>{{ formatDate(item.scheduledStart) }}</td>
                <td>{{ item.changeAge }}</td>
                <td>{{ item.origAge }}</td>
                <td>{{ item.description }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Monthly Unscheduled Jobs (Next Month) -->
        <div *ngIf="activeSection === 'secondMonth'">
          <h5 class="mb-3"><i class="bi bi-calendar text-info me-2"></i>{{ monthLabels[1] || 'Next Month' }} Unscheduled Jobs</h5>
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Call Number</th>
                <th class="fw-bold">Customer ID</th>
                <th class="fw-bold">Customer Name</th>
                <th class="fw-bold">Status</th>
                <th class="fw-bold">Site Contact</th>
                <th class="fw-bold">City</th>
                <th class="fw-bold">Job Due On</th>
                <th class="fw-bold">Current Age</th>
                <th class="fw-bold">Original Age</th>
                <th class="fw-bold">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of getPaginatedData()">
                <td class="fw-bold">{{ item.callNbr }}</td>
                <td>{{ item.custNmbr }}</td>
                <td>{{ item.custName }}</td>
                <td><span class="badge" [ngClass]="getStatusBadgeClass(item, 'secondMonth')">{{ item.jobStatus }}</span></td>
                <td>{{ item.siteContact }}</td>
                <td>{{ item.city }}</td>
                <td>{{ formatDate(item.scheduledStart) }}</td>
                <td>{{ item.changeAge }}</td>
                <td>{{ item.origAge }}</td>
                <td>{{ item.description }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Monthly Unscheduled Jobs (Month 3) -->
        <div *ngIf="activeSection === 'thirdMonth'">
          <h5 class="mb-3"><i class="bi bi-calendar text-info me-2"></i>{{ monthLabels[2] || 'Month 3' }} Unscheduled Jobs</h5>
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Call Number</th>
                <th class="fw-bold">Customer ID</th>
                <th class="fw-bold">Customer Name</th>
                <th class="fw-bold">Status</th>
                <th class="fw-bold">Site Contact</th>
                <th class="fw-bold">City</th>
                <th class="fw-bold">Job Due On</th>
                <th class="fw-bold">Current Age</th>
                <th class="fw-bold">Original Age</th>
                <th class="fw-bold">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of getPaginatedData()">
                <td class="fw-bold">{{ item.callNbr }}</td>
                <td>{{ item.custNmbr }}</td>
                <td>{{ item.custName }}</td>
                <td><span class="badge" [ngClass]="getStatusBadgeClass(item, 'thirdMonth')">{{ item.jobStatus }}</span></td>
                <td>{{ item.siteContact }}</td>
                <td>{{ item.city }}</td>
                <td>{{ formatDate(item.scheduledStart) }}</td>
                <td>{{ item.changeAge }}</td>
                <td>{{ item.origAge }}</td>
                <td>{{ item.description }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Monthly Unscheduled Jobs (Month 4) -->
        <div *ngIf="activeSection === 'fourthMonth'">
          <h5 class="mb-3"><i class="bi bi-calendar text-info me-2"></i>{{ monthLabels[3] || 'Month 4' }} Unscheduled Jobs</h5>
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Call Number</th>
                <th class="fw-bold">Customer ID</th>
                <th class="fw-bold">Customer Name</th>
                <th class="fw-bold">Status</th>
                <th class="fw-bold">Site Contact</th>
                <th class="fw-bold">City</th>
                <th class="fw-bold">Job Due On</th>
                <th class="fw-bold">Current Age</th>
                <th class="fw-bold">Original Age</th>
                <th class="fw-bold">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of getPaginatedData()">
                <td class="fw-bold">{{ item.callNbr }}</td>
                <td>{{ item.custNmbr }}</td>
                <td>{{ item.custName }}</td>
                <td><span class="badge" [ngClass]="getStatusBadgeClass(item, 'fourthMonth')">{{ item.jobStatus }}</span></td>
                <td>{{ item.siteContact }}</td>
                <td>{{ item.city }}</td>
                <td>{{ formatDate(item.scheduledStart) }}</td>
                <td>{{ item.changeAge }}</td>
                <td>{{ item.origAge }}</td>
                <td>{{ item.description }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Monthly Unscheduled Jobs (Month 5) -->
        <div *ngIf="activeSection === 'fifthMonth'">
          <h5 class="mb-3"><i class="bi bi-calendar text-info me-2"></i>{{ monthLabels[4] || 'Month 5' }} Unscheduled Jobs</h5>
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th class="fw-bold">Call Number</th>
                <th class="fw-bold">Customer ID</th>
                <th class="fw-bold">Customer Name</th>
                <th class="fw-bold">Status</th>
                <th class="fw-bold">Site Contact</th>
                <th class="fw-bold">City</th>
                <th class="fw-bold">Job Due On</th>
                <th class="fw-bold">Current Age</th>
                <th class="fw-bold">Original Age</th>
                <th class="fw-bold">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of getPaginatedData()">
                <td class="fw-bold">{{ item.callNbr }}</td>
                <td>{{ item.custNmbr }}</td>
                <td>{{ item.custName }}</td>
                <td><span class="badge" [ngClass]="getStatusBadgeClass(item, 'fifthMonth')">{{ item.jobStatus }}</span></td>
                <td>{{ item.siteContact }}</td>
                <td>{{ item.city }}</td>
                <td>{{ formatDate(item.scheduledStart) }}</td>
                <td>{{ item.changeAge }}</td>
                <td>{{ item.origAge }}</td>
                <td>{{ item.description }}</td>
              </tr>
            </tbody>
          </table>
        </div>

      <!-- Pagination -->
      <div *ngIf="reportData && getActiveData().length > 0 && getTotalPages() > 1"
           class="d-flex justify-content-between align-items-center mt-3">

        <div class="text-muted">
          Page {{ currentPage }} of {{ getTotalPages() }}
        </div>

        <ul class="pagination mb-0">
          <li class="page-item" [class.disabled]="currentPage === 1">
            <button class="page-link" (click)="goToPage(currentPage - 1)">‹</button>
          </li>

          <li class="page-item"
              *ngFor="let page of getPageNumbers()"
              [class.active]="page === currentPage">
            <button class="page-link" (click)="goToPage(page)">
              {{ page }}
            </button>
          </li>

          <li class="page-item" [class.disabled]="currentPage === getTotalPages()">
            <button class="page-link" (click)="goToPage(currentPage + 1)">›</button>
          </li>
        </ul>

      </div>

      <!-- Empty State -->
      <div class="alert alert-info text-center" *ngIf="!isLoading && reportData && getActiveData().length === 0">
        <i class="bi bi-info-circle me-2"></i>
        No records to display for the selected section
      </div>
    </div>
  </div>
</div>