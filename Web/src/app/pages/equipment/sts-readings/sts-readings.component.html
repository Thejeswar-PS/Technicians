<div class="container-fluid ups-readings-container">
  <!-- Header: Back, Title, Save -->
  <div class="ups-readings-header__top mb-4 d-flex justify-content-between align-items-center">
    <button type="button" class="btn btn-sm btn-primary ups-readings-header__back" (click)="goBack()" [disabled]="saving">
      <i class="bi bi-arrow-left me-2"></i>
      Back
    </button>

    <div class="ups-page-title">
      <h2 class="fw-bold text-primary mb-0">
        <i class="bi bi-lightning-charge-fill me-2"></i>
        Static Switch Readings & Verification
      </h2>
      <div class="text-dark mt-2">
        <span class="fw-semibold">Job ID: {{ callNbr || 'N/A' }} | Equipment ID: {{ equipId || 'N/A' }} | STS ID: {{ stsId || 'N/A' }}</span>
      </div>
    </div>

    <div class="d-flex gap-2">
      <button type="button" class="btn btn-sm btn-light-primary" (click)="saveAsDraft()" [disabled]="saving">
        <span *ngIf="saving" class="spinner-border spinner-border-sm me-2" role="status"></span>
        <i *ngIf="!saving" class="bi bi-file-earmark-text me-2"></i>
        {{ saving ? 'Saving...' : 'Save As Draft' }}
      </button>
      <button type="button" class="btn btn-sm btn-primary ups-readings-header__action" (click)="saveSTS()" [disabled]="saving">
        <span *ngIf="saving" class="spinner-border spinner-border-sm me-2" role="status"></span>
        <i *ngIf="!saving" class="bi bi-check-circle me-2"></i>
        {{ saving ? 'Saving...' : 'Save STS Data' }}
      </button>
    </div>
  </div>

  <!-- Messages -->
  <div class="ups-readings-messages mb-3" *ngIf="errorMessage || successMessage">
    <div *ngIf="errorMessage" class="alert alert-danger d-inline-flex align-items-center">
      <i class="bi bi-exclamation-triangle-fill me-2"></i>
      <span>{{ errorMessage }}</span>
    </div>
    <div *ngIf="successMessage" class="alert alert-success d-inline-flex align-items-center">
      <i class="bi bi-check-circle-fill me-2"></i>
      <span>{{ successMessage }}</span>
    </div>
  </div>

  <!-- Main card wrapper -->
  <div class="card shadow-sm ups-main-card">
    <div class="card-body">
      <div class="ups-readings-form">

        <!-- Equipment Verification -->
        <section class="ups-readings-section">
          <div class="ups-section-card">
            <div class="ups-section-header">
              <div class="ups-section-title">
                <i class="bi bi-gear-wide-connected me-2 text-primary"></i>
                <h5 class="mb-0">Equipment Verification</h5>
                <small class="text-muted">Verify STS equipment details and specifications</small>
              </div>
            </div>
            <div class="ups-section-content show">
              <form class="ups-form" [formGroup]="equipmentForm">
                <div class="form-group-modern">
                  <div class="row g-3">
                    <div class="col-md-3">
                      <div class="form-floating">
                        <select class="form-select" formControlName="manufacturer" id="manufacturer">
                          <option value="" disabled>Select manufacturer</option>
                          <option *ngFor="let m of manufacturers" [value]="m.value">{{ m.label }}</option>
                        </select>
                        <label for="manufacturer">Make</label>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-floating">
                        <input type="text" class="form-control" formControlName="modelNo" id="modelNo" placeholder="Model No" />
                        <label for="modelNo">Model No</label>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-floating">
                        <input type="text" class="form-control" formControlName="serialNo" id="serialNo" placeholder="Serial No" />
                        <label for="serialNo">Serial No</label>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-floating">
                        <input type="text" class="form-control" formControlName="location" id="location" placeholder="Location" />
                        <label for="location">Location</label>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-floating">
                        <input type="date" class="form-control" formControlName="dateCode" id="dateCode" placeholder="Date Code" />
                        <label for="dateCode">Date Code</label>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-floating">
                        <input type="text" class="form-control" formControlName="kva" id="kva" placeholder="KVA Rating" />
                        <label for="kva">KVA Rating</label>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-floating">
                        <input type="number" class="form-control" formControlName="temperature" id="temperature" placeholder="Temperature" />
                        <label for="temperature">Temperature (F)</label>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-floating">
                        <select class="form-select" formControlName="status" id="status">
                          <option value="" disabled>Select Status</option>
                          <option *ngFor="let s of statusOptions" [value]="s.value">{{ s.label }}</option>
                        </select>
                        <label for="status">Status</label>
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="form-floating">
                        <textarea rows="3" class="form-control" formControlName="statusNotes" id="statusNotes" placeholder="Reason for Status"></textarea>
                        <label for="statusNotes">Reason for Status</label>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </section>

        <!-- Reconciliation -->
        <section class="ups-readings-section power-verification">
          <div class="ups-section-card">
            <div class="ups-section-header d-flex align-items-center justify-content-between">
              <div class="ups-section-title">
                <i class="bi bi-check-square me-2 text-success"></i>
                <h5 class="mb-0">Equipment Reconciliation</h5>
                <small class="text-muted">Verify recorded information matches actual equipment</small>
              </div>
              <div class="d-flex align-items-center gap-3 ms-auto" [formGroup]="reconciliationForm">
                <div class="form-check mb-0">
                  <input id="verified" class="form-check-input" type="checkbox" formControlName="verified" style="border: 2px solid #009EF7; width: 20px; height: 20px;" />
                  <label for="verified" class="form-check-label fw-bold text-success mb-0">
                    <i class="bi bi-check-circle me-1"></i>
                    Verified
                  </label>
                </div>
              </div>
            </div>
            <div class="ups-section-content show">
              <form class="ups-form" [formGroup]="reconciliationForm">
                <div class="form-group-modern">
                  <div class="row g-3">
                    <div class="col-md-4">
                      <div class="form-floating">
                        <input type="text" class="form-control" formControlName="recModel" readonly id="recModel" placeholder="Model" />
                        <label for="recModel">Model</label>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-floating">
                        <select class="form-select" formControlName="recModelCorrect" id="recModelCorrect">
                          <option *ngFor="let o of yesNoOptions" [value]="o.value">{{ o.label }}</option>
                        </select>
                        <label for="recModelCorrect">Is this Correct?</label>
                      </div>
                    </div>
                    <div class="col-md-5">
                      <div class="form-floating">
                        <input type="text" class="form-control text-danger" formControlName="actModel" id="actModel" placeholder="Actual Model" />
                        <label for="actModel">Actual</label>
                      </div>
                    </div>

                    <div class="col-md-4">
                      <div class="form-floating">
                        <input type="text" class="form-control" formControlName="recSerialNo" readonly id="recSerialNo" placeholder="Serial No" />
                        <label for="recSerialNo">Serial No</label>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-floating">
                        <select class="form-select" formControlName="recSerialNoCorrect" id="recSerialNoCorrect">
                          <option *ngFor="let o of yesNoOptions" [value]="o.value">{{ o.label }}</option>
                        </select>
                        <label for="recSerialNoCorrect">Is this Correct?</label>
                      </div>
                    </div>
                    <div class="col-md-5">
                      <div class="form-floating">
                        <input type="text" class="form-control text-danger" formControlName="actSerialNo" id="actSerialNo" placeholder="Actual Serial No" />
                        <label for="actSerialNo">Actual</label>
                      </div>
                    </div>

                    <div class="col-md-4">
                      <div class="form-floating">
                        <input type="text" class="form-control" formControlName="kvaSize" readonly id="kvaSize" placeholder="KVA Size" />
                        <label for="kvaSize">KVA Size</label>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-floating">
                        <select class="form-select" formControlName="kvaCorrect" id="kvaCorrect">
                          <option *ngFor="let o of yesNoOptions" [value]="o.value">{{ o.label }}</option>
                        </select>
                        <label for="kvaCorrect">Is this Correct?</label>
                      </div>
                    </div>
                    <div class="col-md-5">
                      <div class="form-floating">
                        <input type="text" class="form-control text-danger" formControlName="actKVA" id="actKVA" placeholder="Actual KVA" />
                        <label for="actKVA">Actual</label>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </section>

        <!-- Visual and Mechanical Verification -->
        <section class="ups-readings-section">
          <div class="ups-section-card">
            <div class="ups-section-header">
              <div class="ups-section-title">
                <i class="bi bi-tools me-2 text-primary"></i>
                <h5 class="mb-0">STS Visual and Mechanical Verification</h5>
                <small class="text-muted">Pass/Fail checks for critical components</small>
              </div>
            </div>
            <div class="ups-section-content show">
              <form class="ups-form" [formGroup]="visualForm">
                <div class="form-group-modern">
                  <div class="row g-3">
                    <div class="col-md-3" *ngFor="let field of [
                      { key: 'busswork', label: '1. Busswork' },
                      { key: 'transformers', label: '2. Transformers' },
                      { key: 'powerConn', label: '3. Power Connections' },
                      { key: 'mainCirBreaks', label: '4. Main Circuit Breakers' },
                      { key: 'subfeedCirBreaks', label: '5. Subfeed Circuit Breakers' },
                      { key: 'currentCTs', label: '6. Current CT\'s' },
                      { key: 'circuitBoards', label: '7. Circuit Boards' },
                      { key: 'filterCapacitors', label: '8. Capacitors / Fan' },
                      { key: 'epoConn', label: '9. EPO Connections' },
                      { key: 'wiringConn', label: '10. Wiring Connections' },
                      { key: 'ribbonCables', label: '11. Ribbon Cables / Terminals' },
                      { key: 'compAirClean', label: '12. Compressed Air Cleaned' },
                      { key: 'frontPanel', label: '14. Verify front panel indicators' },
                      { key: 'internalPower', label: '15. Verify internal power supply' },
                      { key: 'localMonitoring', label: '16. Verify local monitoring' },
                      { key: 'localEPO', label: '17. Verify local EPO' }
                    ]">
                      <div class="form-floating">
                        <select class="form-select" [formControlName]="field.key">
                          <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                        </select>
                        <label>{{ field.label }}</label>
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="form-floating">
                        <textarea rows="3" class="form-control" placeholder="Please note the reason, if any." formControlName="comments1"></textarea>
                        <label class="form-label">Comments</label>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </section>

        <!-- Power Verification -->
        <section class="ups-readings-section">
          <div class="ups-section-card">
            <div class="ups-section-header">
              <div class="ups-section-title">
                <i class="bi bi-lightning me-2 text-danger"></i>
                <h5 class="mb-0">Power Verification</h5>
                <small class="text-muted">Inputs, outputs, and transfer checks</small>
              </div>
            </div>
            <div class="ups-section-content show">

              <!-- Input Source 1 -->
              <div class="mb-4">
                <form [formGroup]="inputSource1Form">
                  <div class="input-config-bar d-flex align-items-center justify-content-between p-3 bg-light border rounded-3 shadow-sm">
                    <div class="config-item d-flex align-items-center">
                      <label class="form-label mb-0 me-2 fw-semibold text-white input-label">
                        <i class="bi bi-arrow-down-circle me-1"></i>Input (Source 1):
                      </label>
                      <select class="form-select form-select-sm custom-select" formControlName="inputSource1" (change)="onInputSource1Change()" style="min-width: 150px; max-width: 150px;">
                        <option *ngFor="let config of voltageConfigs" [value]="config.value">{{ config.label }}</option>
                      </select>
                    </div>
                    <div class="tolerance-info d-flex align-items-center" *ngIf="getInputConfig(selectedInputSource1)">
                      <div class="d-flex flex-column">
                        <small class="text-primary fw-semibold mb-1">
                          <i class="bi bi-info-circle me-1"></i>
                          V-Tolerance: {{ getInputConfig(selectedInputSource1)?.tolerance || '—' }}
                        </small>
                        <small class="text-info fw-semibold">
                          <i class="bi bi-speedometer me-1"></i>
                          Freq: {{ getInputConfig(selectedInputSource1)?.freqTolerance || '55 Hz - 65 Hz' }}
                        </small>
                      </div>
                    </div>

                    <!-- Filter Current Toggle -->
                    <div class="config-item d-flex align-items-center" *ngIf="selectedInputSource1 !== '0'">
                      <div class="custom-toggle-container">
                        <input
                          class="custom-toggle-input"
                          type="checkbox"
                          formControlName="inputSrc1FilterCurrent"
                          id="inputSrc1FilterCurrent"
                        />
                        <label class="custom-toggle-label" for="inputSrc1FilterCurrent">
                          <span class="toggle-switch"></span>
                          <span class="toggle-text">
                            <i class="bi bi-funnel me-1"></i>Filter Current
                          </span>
                        </label>
                      </div>
                    </div>

                    <!-- THD % Toggle -->
                    <!-- <div class="config-item d-flex align-items-center" *ngIf="selectedInputSource1 !== '0'">
                      <div class="custom-toggle-container">
                        <input
                          class="custom-toggle-input"
                          type="checkbox"
                          formControlName="inputSrc1ThdPercent"
                          id="inputSrc1ThdPercent"
                        />
                        <label class="custom-toggle-label" for="inputSrc1ThdPercent">
                          <span class="toggle-switch"></span>
                          <span class="toggle-text">
                            <i class="bi bi-graph-up me-1"></i>THD %
                          </span>
                        </label>
                      </div>
                    </div> -->
                  </div>

                  <!-- Input Source 1 Phase Measurements -->
                  <div class="mb-4" *ngIf="selectedInputSource1 !== '0'">
                    <h6 class="fw-bold text-success mb-3">
                      <i class="bi bi-plug me-2"></i>
                      Input Source 1 Phase Measurements
                      <small class="text-muted ms-2">Voltage, Current, and Frequency readings</small>
                    </h6>
                  </div>

                  <!-- 120V -->
                  <div *ngIf="showInputSrc1_120" class="mb-4">
                    <div class="row g-3">
                      <!-- Voltage A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_120VoltA" step="0.01" placeholder="Voltage A" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_120VoltA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_120CurrA" step="0.01" placeholder="Current A" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_120CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Frequency Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_120Freq" step="0.01" placeholder="Frequency" />
                                  <label class="text-muted">Frequency</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_120Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 240V -->
                  <div *ngIf="showInputSrc1_240" class="mb-4">
                    <div class="row g-3">
                      <!-- Voltage A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_240VoltA" step="0.01" placeholder="Voltage A" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_240VoltA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_240CurrA" step="0.01" placeholder="Current A" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_240CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Voltage B Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_240VoltB" step="0.01" placeholder="Voltage B" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_240VoltB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current B Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_240CurrB" step="0.01" placeholder="Current B" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_240CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Frequency Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_240Freq" step="0.01" placeholder="Frequency" />
                                  <label class="text-muted">Frequency</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_240Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 208V -->
                  <div *ngIf="showInputSrc1_208" class="mb-3">
                    <div class="row g-3">
                      <!-- Voltage A-B Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_208VoltAB" step="0.01" placeholder="Voltage A-B" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_208VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_208VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Voltage B-C Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_208VoltBC" step="0.01" placeholder="Voltage B-C" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_208VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_208VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Voltage C-A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_208VoltCA" step="0.01" placeholder="Voltage C-A" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_208VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_208VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_208CurrA" step="0.01" placeholder="Current A" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_208CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current B Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_208CurrB" step="0.01" placeholder="Current B" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_208CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current C Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_208CurrC" step="0.01" placeholder="Current C" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_208CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Frequency Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_208Freq" step="0.01" placeholder="Frequency" />
                                  <label class="text-muted">Frequency</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_208Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 480V -->
                  <div *ngIf="showInputSrc1_480" class="mb-3">
                    <div class="row g-3">
                      <!-- Voltage A-B Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_480VoltAB" step="0.01" placeholder="Voltage A-B" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_480VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_480VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Voltage B-C Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_480VoltBC" step="0.01" placeholder="Voltage B-C" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_480VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_480VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Voltage C-A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_480VoltCA" step="0.01" placeholder="Voltage C-A" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_480VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_480VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_480CurrA" step="0.01" placeholder="Current A" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_480CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current B Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_480CurrB" step="0.01" placeholder="Current B" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_480CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current C Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_480CurrC" step="0.01" placeholder="Current C" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_480CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Frequency Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_480Freq" step="0.01" placeholder="Frequency" />
                                  <label class="text-muted">Frequency</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_480Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 575V -->
                  <div *ngIf="showInputSrc1_575" class="mb-3">
                    <div class="row g-3">
                      <!-- Voltage A-B Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_575VoltAB" step="0.01" placeholder="Voltage A-B" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_575VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_575VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Voltage B-C Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_575VoltBC" step="0.01" placeholder="Voltage B-C" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_575VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_575VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Voltage C-A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_575VoltCA" step="0.01" placeholder="Voltage C-A" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_575VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_575VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_575CurrA" step="0.01" placeholder="Current A" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_575CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current B Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_575CurrB" step="0.01" placeholder="Current B" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_575CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current C Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_575CurrC" step="0.01" placeholder="Current C" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_575CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Frequency Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_575Freq" step="0.01" placeholder="Frequency" />
                                  <label class="text-muted">Frequency</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_575Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 600V -->
                  <div *ngIf="showInputSrc1_600" class="mb-3">
                    <div class="row g-3">
                      <!-- Voltage A-B Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_600VoltAB" step="0.01" placeholder="Voltage A-B" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_600VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_600VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Voltage B-C Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_600VoltBC" step="0.01" placeholder="Voltage B-C" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_600VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_600VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Voltage C-A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_600VoltCA" step="0.01" placeholder="Voltage C-A" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource1Form.get('src1_600VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_600VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_600CurrA" step="0.01" placeholder="Current A" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_600CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current B Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_600CurrB" step="0.01" placeholder="Current B" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_600CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current C Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_600CurrC" step="0.01" placeholder="Current C" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_600CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Frequency Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src1_600Freq" step="0.01" placeholder="Frequency" />
                                  <label class="text-muted">Frequency</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src1_600Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Input Source 1 Filter Current Detail Section -->
                  <div *ngIf="showInputSrc1FilterCurrent" class="dynamic-section mt-3">
                    <div class="mb-3">
                      <h6 class="fw-bold text-primary mb-3">
                        <i class="bi bi-funnel me-2"></i>
                        Input Source 1 Filter Current Measurements
                        <small class="text-muted ms-2">Filter current readings for each phase</small>
                      </h6>

                      <div class="row g-3">
                        <div class="col-xl-4 col-lg-6 col-md-12" *ngFor="let phase of ['A','B','C']; let i = index">
                          <div class="power-measurement-card">
                            <div class="power-card-header">
                              <div class="power-card-title">
                                <i class="bi bi-electric-scooter text-primary me-2"></i>
                                <span class="fw-semibold text-dark">Filter Current {{ phase }}</span>
                              </div>
                            </div>
                            <div class="power-card-body">
                              <div class="row g-2">
                                <div class="col-8">
                                  <div class="form-floating">
                                    <input
                                      type="text"
                                      class="form-control power-input"
                                      [formControlName]="'src1FilterCurrent' + phase"
                                      [id]="'src1FilterCurrent' + phase"
                                    />
                                    <label class="text-muted" [for]="'src1FilterCurrent' + phase">Current (A)</label>
                                  </div>
                                </div>
                                <div class="col-4">
                                  <div class="form-floating">
                                    <select
                                      class="form-select power-select"
                                      [formControlName]="'src1FilterCurrent' + phase + '_PF'"
                                      [id]="'src1FilterCurrent' + phase + 'Status'"
                                    >
                                      <option value="">Select status...</option>
                                      <option value="P">Pass</option>
                                      <option value="F">Fail</option>
                                      <option value="A">N/A</option>
                                    </select>
                                    <label class="text-muted" [for]="'src1FilterCurrent' + phase + 'Status'">Status</label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Input Source 1 THD Detail Section -->
                  <!-- <div *ngIf="showInputSrc1THD" class="dynamic-section mt-3">
                    <div class="mb-3">
                      <h6 class="fw-bold text-warning mb-3">
                        <i class="bi bi-graph-up-arrow me-2"></i>
                        Input Source 1 THD (Total Harmonic Distortion) Measurements
                        <small class="text-muted ms-2">THD percentage readings for each phase</small>
                      </h6>

                      <div class="row g-3">
                        <div class="col-xl-4 col-lg-6 col-md-12" *ngFor="let phase of ['A','B','C']; let i = index">
                          <div class="power-measurement-card">
                            <div class="power-card-header">
                              <div class="power-card-title">
                                <i class="bi bi-activity text-warning me-2"></i>
                                <span class="fw-semibold text-dark">THD {{ phase }}</span>
                              </div>
                            </div>
                            <div class="power-card-body">
                              <div class="row g-2">
                                <div class="col-8">
                                  <div class="form-floating">
                                    <input
                                      type="text"
                                      class="form-control power-input"
                                      [formControlName]="'src1Thd' + phase"
                                      [id]="'src1Thd' + phase"
                                    />
                                    <label class="text-muted" [for]="'src1Thd' + phase">THD (%)</label>
                                  </div>
                                </div>
                                <div class="col-4">
                                  <div class="form-floating">
                                    <select
                                      class="form-select power-select"
                                      [formControlName]="'src1Thd' + phase + '_PF'"
                                      [id]="'src1Thd' + phase + 'Status'"
                                    >
                                      <option value="">Select status...</option>
                                      <option value="P">Pass</option>
                                      <option value="F">Fail</option>
                                      <option value="A">N/A</option>
                                    </select>
                                    <label class="text-muted" [for]="'src1Thd' + phase + 'Status'">Status</label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div> -->
                </form>
              </div>

              <!-- Input Source 2 -->
              <div class="mb-4">
                <form [formGroup]="inputSource2Form">
                  <div class="input-config-bar d-flex align-items-center justify-content-between p-3 bg-light border rounded-3 shadow-sm">
                    <div class="config-item d-flex align-items-center">
                      <label class="form-label mb-0 me-2 fw-semibold text-white input-label">
                        <i class="bi bi-arrow-down-circle me-1"></i>Input (Source 2):
                      </label>
                      <select class="form-select form-select-sm custom-select" formControlName="inputSource2" (change)="onInputSource2Change()" style="min-width: 150px; max-width: 150px;">
                        <option *ngFor="let config of voltageConfigs" [value]="config.value">{{ config.label }}</option>
                      </select>
                    </div>
                    <div class="tolerance-info d-flex align-items-center" *ngIf="getInputConfig(selectedInputSource2)">
                      <div class="d-flex flex-column">
                        <small class="text-primary fw-semibold mb-1">
                          <i class="bi bi-info-circle me-1"></i>
                          V-Tolerance: {{ getInputConfig(selectedInputSource2)?.tolerance || '—' }}
                        </small>
                        <small class="text-info fw-semibold">
                          <i class="bi bi-speedometer me-1"></i>
                          Freq: {{ getInputConfig(selectedInputSource2)?.freqTolerance || '55 Hz - 65 Hz' }}
                        </small>
                      </div>
                    </div>

                    <!-- Filter Current Toggle -->
                    <!-- <div class="config-item d-flex align-items-center" *ngIf="selectedInputSource2 !== '0'">
                      <div class="custom-toggle-container">
                        <input
                          class="custom-toggle-input"
                          type="checkbox"
                          formControlName="inputSrc2FilterCurrent"
                          id="inputSrc2FilterCurrent"
                        />
                        <label class="custom-toggle-label" for="inputSrc2FilterCurrent">
                          <span class="toggle-switch"></span>
                          <span class="toggle-text">
                            <i class="bi bi-funnel me-1"></i>Filter Current
                          </span>
                        </label>
                      </div>
                    </div> -->

                    <!-- THD % Toggle -->
                    <!-- <div class="config-item d-flex align-items-center" *ngIf="selectedInputSource2 !== '0'">
                      <div class="custom-toggle-container">
                        <input
                          class="custom-toggle-input"
                          type="checkbox"
                          formControlName="inputSrc2ThdPercent"
                          id="inputSrc2ThdPercent"
                        />
                        <label class="custom-toggle-label" for="inputSrc2ThdPercent">
                          <span class="toggle-switch"></span>
                          <span class="toggle-text">
                            <i class="bi bi-graph-up me-1"></i>THD %
                          </span>
                        </label>
                      </div>
                    </div> -->
                  </div>

                  <!-- Input Source 2 Phase Measurements -->
                  <div class="mb-4" *ngIf="selectedInputSource2 !== '0'">
                    <h6 class="fw-bold text-success mb-3">
                      <i class="bi bi-plug me-2"></i>
                      Input Source 2 Phase Measurements
                      <small class="text-muted ms-2">Voltage, Current, and Frequency readings</small>
                    </h6>
                  </div>

                  <!-- 120V -->
                  <div *ngIf="showInputSrc2_120" class="mb-4">
                    <div class="row g-3">
                      <!-- Voltage A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_120VoltA" step="0.01" placeholder="Voltage A" />
                                  <label class="text-muted">Voltage</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_120VoltA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Current A Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_120CurrA" step="0.01" placeholder="Current A" />
                                  <label class="text-muted">Current</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_120CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Frequency Card -->
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_120Freq" step="0.01" placeholder="Frequency" />
                                  <label class="text-muted">Frequency</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_120Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 240V -->
                  <div *ngIf="showInputSrc2_240" class="mb-3">
                    <div class="row g-3">
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_240VoltA" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_240VoltA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_240CurrA" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_240CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_240VoltB" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_240VoltB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_240CurrB" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_240CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_240Freq" step="0.01" />
                                  <label class="text-muted">Frequency (Hz)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_240Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 208V -->
                  <div *ngIf="showInputSrc2_208" class="mb-3">
                    <div class="row g-3">
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_208VoltAB" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_208VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_208VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_208VoltBC" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_208VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_208VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_208VoltCA" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_208VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_208VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_208CurrA" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_208CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_208CurrB" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_208CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_208CurrC" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_208CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_208Freq" step="0.01" />
                                  <label class="text-muted">Frequency (Hz)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_208Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 480V -->
                  <div *ngIf="showInputSrc2_480" class="mb-3">
                    <div class="row g-3">
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_480VoltAB" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_480VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_480VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_480VoltBC" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_480VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_480VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_480VoltCA" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_480VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_480VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_480CurrA" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_480CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_480CurrB" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_480CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_480CurrC" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_480CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_480Freq" step="0.01" />
                                  <label class="text-muted">Frequency (Hz)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_480Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 575V -->
                  <div *ngIf="showInputSrc2_575" class="mb-3">
                    <div class="row g-3">
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_575VoltAB" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_575VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_575VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_575VoltBC" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_575VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_575VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_575VoltCA" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_575VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_575VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_575CurrA" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_575CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_575CurrB" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_575CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_575CurrC" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_575CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_575Freq" step="0.01" />
                                  <label class="text-muted">Frequency (Hz)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_575Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 600V -->
                  <div *ngIf="showInputSrc2_600" class="mb-3">
                    <div class="row g-3">
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_600VoltAB" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_600VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_600VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_600VoltBC" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_600VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_600VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_600VoltCA" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(inputSource2Form.get('src2_600VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_600VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_600CurrA" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_600CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_600CurrB" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_600CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_600CurrC" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_600CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="src2_600Freq" step="0.01" />
                                  <label class="text-muted">Frequency (Hz)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="src2_600Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Input Source 2 Filter Current Detail Section -->
                  <!-- <div *ngIf="showInputSrc2FilterCurrent" class="dynamic-section mt-3">
                    <div class="mb-3">
                      <h6 class="fw-bold text-primary mb-3">
                        <i class="bi bi-funnel me-2"></i>
                        Input Source 2 Filter Current Measurements
                        <small class="text-muted ms-2">Filter current readings for each phase</small>
                      </h6>

                      <div class="row g-3">
                        <div class="col-xl-4 col-lg-6 col-md-12" *ngFor="let phase of ['A','B','C']; let i = index">
                          <div class="power-measurement-card">
                            <div class="power-card-header">
                              <div class="power-card-title">
                                <i class="bi bi-electric-scooter text-primary me-2"></i>
                                <span class="fw-semibold text-dark">Filter Current {{ phase }}</span>
                              </div>
                            </div>
                            <div class="power-card-body">
                              <div class="row g-2">
                                <div class="col-8">
                                  <div class="form-floating">
                                    <input
                                      type="text"
                                      class="form-control power-input"
                                      [formControlName]="'src2FilterCurrent' + phase"
                                      [id]="'src2FilterCurrent' + phase"
                                    />
                                    <label class="text-muted" [for]="'src2FilterCurrent' + phase">Current (A)</label>
                                  </div>
                                </div>
                                <div class="col-4">
                                  <div class="form-floating">
                                    <select
                                      class="form-select power-select"
                                      [formControlName]="'src2FilterCurrent' + phase + '_PF'"
                                      [id]="'src2FilterCurrent' + phase + 'Status'"
                                    >
                                      <option value="">Select status...</option>
                                      <option value="P">Pass</option>
                                      <option value="F">Fail</option>
                                      <option value="A">N/A</option>
                                    </select>
                                    <label class="text-muted" [for]="'src2FilterCurrent' + phase + 'Status'">Status</label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div> -->

                  <!-- Input Source 2 THD Detail Section -->
                  <!-- <div *ngIf="showInputSrc2THD" class="dynamic-section mt-3">
                    <div class="mb-3">
                      <h6 class="fw-bold text-warning mb-3">
                        <i class="bi bi-graph-up-arrow me-2"></i>
                        Input Source 2 THD (Total Harmonic Distortion) Measurements
                        <small class="text-muted ms-2">THD percentage readings for each phase</small>
                      </h6>

                      <div class="row g-3">
                        <div class="col-xl-4 col-lg-6 col-md-12" *ngFor="let phase of ['A','B','C']; let i = index">
                          <div class="power-measurement-card">
                            <div class="power-card-header">
                              <div class="power-card-title">
                                <i class="bi bi-activity text-warning me-2"></i>
                                <span class="fw-semibold text-dark">THD {{ phase }}</span>
                              </div>
                            </div>
                            <div class="power-card-body">
                              <div class="row g-2">
                                <div class="col-8">
                                  <div class="form-floating">
                                    <input
                                      type="text"
                                      class="form-control power-input"
                                      [formControlName]="'src2Thd' + phase"
                                      [id]="'src2Thd' + phase"
                                    />
                                    <label class="text-muted" [for]="'src2Thd' + phase">THD (%)</label>
                                  </div>
                                </div>
                                <div class="col-4">
                                  <div class="form-floating">
                                    <select
                                      class="form-select power-select"
                                      [formControlName]="'src2Thd' + phase + '_PF'"
                                      [id]="'src2Thd' + phase + 'Status'"
                                    >
                                      <option value="">Select status...</option>
                                      <option value="P">Pass</option>
                                      <option value="F">Fail</option>
                                      <option value="A">N/A</option>
                                    </select>
                                    <label class="text-muted" [for]="'src2Thd' + phase + 'Status'">Status</label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div> -->
                </form>
              </div>

              <!-- Output -->
              <div class="mb-4">
                <form [formGroup]="outputForm">
                  <h6 class="fw-bold text-info mb-3">
                    <i class="bi bi-arrow-up-circle me-2"></i>
                    Output Phase Measurements
                    <small class="text-muted ms-2">Voltage, Current, Load, and Frequency readings</small>
                  </h6>

                  <div class="input-config-bar d-flex align-items-center justify-content-between p-3 bg-light border rounded-3 shadow-sm">
                    <div class="config-item d-flex align-items-center">
                      <label class="form-label mb-0 me-2 fw-semibold text-white input-label">
                        <i class="bi bi-arrow-up-circle me-1"></i>Output:
                      </label>
                      <select class="form-select form-select-sm custom-select" formControlName="output" (change)="onOutputChange()" style="min-width: 150px; max-width: 150px;">
                        <option *ngFor="let config of outputVoltageConfigs" [value]="config.value">{{ config.label }}</option>
                      </select>
                    </div>
                    <div class="tolerance-info d-flex align-items-center" *ngIf="getOutputConfig(selectedOutput)">
                      <div class="d-flex flex-column">
                        <small class="text-primary fw-semibold mb-1">
                          <i class="bi bi-info-circle me-1"></i>
                          V-Tolerance: {{ getOutputConfig(selectedOutput)?.tolerance || '—' }}
                        </small>
                        <small class="text-info fw-semibold">
                          <i class="bi bi-speedometer me-1"></i>
                          Freq: {{ getOutputConfig(selectedOutput)?.freqTolerance || '58 Hz - 62 Hz' }}
                        </small>
                      </div>
                    </div>

                    <!-- Filter Current Toggle -->
                    <div class="config-item d-flex align-items-center" *ngIf="selectedOutput !== '0'">
                      <div class="custom-toggle-container">
                        <input
                          class="custom-toggle-input"
                          type="checkbox"
                          formControlName="outputFilterCurrent"
                          id="outputFilterCurrent"
                        />
                        <label class="custom-toggle-label" for="outputFilterCurrent">
                          <span class="toggle-switch"></span>
                          <span class="toggle-text">
                            <i class="bi bi-funnel me-1"></i>Filter Current
                          </span>
                        </label>
                      </div>
                    </div>

                    <!-- THD % Toggle -->
                    <!-- <div class="config-item d-flex align-items-center" *ngIf="selectedOutput !== '0'">
                      <div class="custom-toggle-container">
                        <input
                          class="custom-toggle-input"
                          type="checkbox"
                          formControlName="outputThdPercent"
                          id="outputThdPercent"
                        />
                        <label class="custom-toggle-label" for="outputThdPercent">
                          <span class="toggle-switch"></span>
                          <span class="toggle-text">
                            <i class="bi bi-graph-up me-1"></i>THD %
                          </span>
                        </label>
                      </div>
                    </div> -->
                  </div>

                  <!-- 120V -->
                  <div *ngIf="showOutput120" class="mb-3">
                    <div class="row g-3">
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output120VoltA" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output120VoltA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output120CurrA" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output120CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output120Freq" step="0.01" />
                                  <label class="text-muted">Frequency (Hz)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output120Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output120LoadA" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output120LoadA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Total Load %</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output120TotalLoad" step="0.01" />
                                  <label class="text-muted">Total Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <button type="button" class="btn btn-sm btn-dark w-100" (click)="calculateOutputLoadPercent()">
                                  <i class="bi bi-calculator"></i>
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 240V -->
                  <div *ngIf="showOutput240" class="mb-3">
                    <div class="row g-3">
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output240VoltA" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output240VoltA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output240CurrA" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output240CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output240VoltB" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output240VoltB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output240CurrB" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output240CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output240Freq" step="0.01" />
                                  <label class="text-muted">Frequency (Hz)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output240Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output240LoadA" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output240LoadA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output240LoadB" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output240LoadB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Total Load %</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output240TotalLoad" step="0.01" />
                                  <label class="text-muted">Total Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <button type="button" class="btn btn-sm btn-dark w-100" (click)="calculateOutputLoadPercent()">
                                  <i class="bi bi-calculator"></i>
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 208V -->
                  <div *ngIf="showOutput208" class="mb-3">
                    <div class="row g-3">
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output208VoltAB" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output208VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output208VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output208VoltBC" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output208VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output208VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output208VoltCA" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output208VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output208VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output208CurrA" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output208CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output208CurrB" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output208CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output208CurrC" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output208CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output208Freq" step="0.01" />
                                  <label class="text-muted">Frequency (Hz)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output208Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output208LoadA" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output208LoadA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output208LoadB" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output208LoadB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output208LoadC" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output208LoadC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Total Load %</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output208TotalLoad" step="0.01" />
                                  <label class="text-muted">Total Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <button type="button" class="btn btn-sm btn-dark w-100" (click)="calculateOutputLoadPercent()">
                                  <i class="bi bi-calculator"></i>
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 480V -->
                  <div *ngIf="showOutput480" class="mb-3">
                    <div class="row g-3">
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output480VoltAB" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output480VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output480VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output480VoltBC" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output480VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output480VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output480VoltCA" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output480VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output480VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output480CurrA" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output480CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output480CurrB" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output480CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output480CurrC" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output480CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output480Freq" step="0.01" />
                                  <label class="text-muted">Frequency (Hz)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output480Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output480LoadA" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output480LoadA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output480LoadB" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output480LoadB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output480LoadC" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output480LoadC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Total Load %</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output480TotalLoad" step="0.01" />
                                  <label class="text-muted">Total Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <button type="button" class="btn btn-sm btn-dark w-100" (click)="calculateOutputLoadPercent()">
                                  <i class="bi bi-calculator"></i>
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 575V -->
                  <div *ngIf="showOutput575" class="mb-3">
                    <div class="row g-3">
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output575VoltAB" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output575VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output575VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output575VoltBC" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output575VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output575VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output575VoltCA" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output575VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output575VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output575CurrA" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output575CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output575CurrB" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output575CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output575CurrC" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output575CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output575Freq" step="0.01" />
                                  <label class="text-muted">Frequency (Hz)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output575Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output575LoadA" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output575LoadA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output575LoadB" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output575LoadB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output575LoadC" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output575LoadC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Total Load %</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output575TotalLoad" step="0.01" />
                                  <label class="text-muted">Total Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <button type="button" class="btn btn-sm btn-dark w-100" (click)="calculateOutputLoadPercent()">
                                  <i class="bi bi-calculator"></i>
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 600V -->
                  <div *ngIf="showOutput600" class="mb-3">
                    <div class="row g-3">
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage A-B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output600VoltAB" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('AB') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output600VoltAB')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output600VoltAB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage B-C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output600VoltBC" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('BC') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output600VoltBC')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output600VoltBC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Voltage C-A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output600VoltCA" step="0.01" />
                                  <label class="text-muted">Voltage (V)</label>
                                </div>
                                <div class="p-n-display-inline mt-1">
                                  <small class="text-muted d-flex align-items-center justify-content-between">
                                    <span><i class="bi bi-calculator text-info me-1"></i>{{ getPhaseToNeutralLabel('CA') }}:</span>
                                    <span class="badge bg-light text-dark ms-2">{{ calculatePhaseToNeutral(outputForm.get('output600VoltCA')?.value) || '—' }}V</span>
                                  </small>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output600VoltCA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output600CurrA" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output600CurrA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output600CurrB" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output600CurrB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Current C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output600CurrC" step="0.01" />
                                  <label class="text-muted">Current (A)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output600CurrC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Frequency</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output600Freq" step="0.01" />
                                  <label class="text-muted">Frequency (Hz)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output600Freq_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % A</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output600LoadA" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output600LoadA_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % B</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output600LoadB" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output600LoadB_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Load % C</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output600LoadC" step="0.01" />
                                  <label class="text-muted">Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <div class="form-floating">
                                  <select class="form-select power-select" formControlName="output600LoadC_PF">
                                    <option value="">Select...</option>
                                    <option *ngFor="let o of passFailOptions" [value]="o.value">{{ o.label }}</option>
                                  </select>
                                  <label class="text-muted">Status</label>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6">
                        <div class="power-measurement-card">
                          <div class="power-card-header">
                            <div class="power-card-title">
                              <span class="fw-semibold text-dark">Total Load %</span>
                            </div>
                          </div>
                          <div class="power-card-body">
                            <div class="row g-2">
                              <div class="col-8">
                                <div class="form-floating">
                                  <input type="number" class="form-control power-input" formControlName="output600TotalLoad" step="0.01" />
                                  <label class="text-muted">Total Load (%)</label>
                                </div>
                              </div>
                              <div class="col-4">
                                <button type="button" class="btn btn-sm btn-dark w-100" (click)="calculateOutputLoadPercent()">
                                  <i class="bi bi-calculator"></i>
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Output Filter Current Detail Section -->
                  <div *ngIf="showOutputFilterCurrent" class="dynamic-section mt-3">
                    <div class="mb-3">
                      <h6 class="fw-bold text-primary mb-3">
                        <i class="bi bi-funnel me-2"></i>
                        Output Filter Current Measurements
                        <small class="text-muted ms-2">Filter current readings for each phase</small>
                      </h6>

                      <div class="row g-3">
                        <div class="col-xl-4 col-lg-6 col-md-12" *ngFor="let phase of ['A','B','C']; let i = index">
                          <div class="power-measurement-card">
                            <div class="power-card-header">
                              <div class="power-card-title">
                                <i class="bi bi-electric-scooter text-primary me-2"></i>
                                <span class="fw-semibold text-dark">Filter Current {{ phase }}</span>
                              </div>
                            </div>
                            <div class="power-card-body">
                              <div class="row g-2">
                                <div class="col-8">
                                  <div class="form-floating">
                                    <input
                                      type="text"
                                      class="form-control power-input"
                                      [formControlName]="'outputFilterCurrent' + phase"
                                      [id]="'outputFilterCurrent' + phase"
                                    />
                                    <label class="text-muted" [for]="'outputFilterCurrent' + phase">Current (A)</label>
                                  </div>
                                </div>
                                <div class="col-4">
                                  <div class="form-floating">
                                    <select
                                      class="form-select power-select"
                                      [formControlName]="'outputFilterCurrent' + phase + '_PF'"
                                      [id]="'outputFilterCurrent' + phase + 'Status'"
                                    >
                                      <option value="">Select status...</option>
                                      <option value="P">Pass</option>
                                      <option value="F">Fail</option>
                                      <option value="A">N/A</option>
                                    </select>
                                    <label class="text-muted" [for]="'outputFilterCurrent' + phase + 'Status'">Status</label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Output THD Detail Section -->
                  <!-- <div *ngIf="showOutputTHD" class="dynamic-section mt-3">
                    <div class="mb-3">
                      <h6 class="fw-bold text-warning mb-3">
                        <i class="bi bi-graph-up-arrow me-2"></i>
                        Output THD (Total Harmonic Distortion) Measurements
                        <small class="text-muted ms-2">THD percentage readings for each phase</small>
                      </h6>

                      <div class="row g-3">
                        <div class="col-xl-4 col-lg-6 col-md-12" *ngFor="let phase of ['A','B','C']; let i = index">
                          <div class="power-measurement-card">
                            <div class="power-card-header">
                              <div class="power-card-title">
                                <i class="bi bi-activity text-warning me-2"></i>
                                <span class="fw-semibold text-dark">THD {{ phase }}</span>
                              </div>
                            </div>
                            <div class="power-card-body">
                              <div class="row g-2">
                                <div class="col-8">
                                  <div class="form-floating">
                                    <input
                                      type="text"
                                      class="form-control power-input"
                                      [formControlName]="'outputThd' + phase"
                                      [id]="'outputThd' + phase"
                                    />
                                    <label class="text-muted" [for]="'outputThd' + phase">THD (%)</label>
                                  </div>
                                </div>
                                <div class="col-4">
                                  <div class="form-floating">
                                    <select
                                      class="form-select power-select"
                                      [formControlName]="'outputThd' + phase + '_PF'"
                                      [id]="'outputThd' + phase + 'Status'"
                                    >
                                      <option value="">Select status...</option>
                                      <option value="P">Pass</option>
                                      <option value="F">Fail</option>
                                      <option value="A">N/A</option>
                                    </select>
                                    <label class="text-muted" [for]="'outputThd' + phase + 'Status'">Status</label>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div> -->
                </form>
              </div>

              <!-- Transfer Verification -->
              <div class="sts-section-title mt-4">
                <i class="bi bi-arrow-left-right me-2 text-info"></i>
                <h6 class="fw-bold text-info mb-0">
                  Transfer Verification
                  <small class="text-muted ms-2">Verify all transfer modes and functionality</small>
                </h6>
              </div>

              <form [formGroup]="transferVerificationForm" class="mt-3">
                <div class="row g-3">
                  <div class="col-6">
                    <div class="power-measurement-card">
                      <div class="power-card-header">
                        <i class="bi bi-clipboard-check text-primary"></i>
                        <h6 class="mb-0 fw-semibold">Transfer Verification</h6>
                      </div>
                      <div class="power-card-body">
                        <div class="d-flex align-items-center gap-3">
                          <label class="form-label text-muted mb-0 text-nowrap">Major PM Only:</label>
                          <select class="form-select power-select flex-grow-1" formControlName="transferVerification">
                            <option value="">Select status</option>
                            <option *ngFor="let opt of passFailOptions" [value]="opt.value">{{ opt.label }}</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-6">
                    <div class="power-measurement-card">
                      <div class="power-card-header">
                        <i class="bi bi-arrow-repeat text-info"></i>
                        <h6 class="mb-0 fw-semibold">Preferred ↔ Alternate Source</h6>
                      </div>
                      <div class="power-card-body">
                        <div class="d-flex align-items-center gap-3">
                          <label class="form-label text-muted mb-0 text-nowrap">Transfer and verify (Vice Versa):</label>
                          <select class="form-select power-select flex-grow-1" formControlName="prefAlter">
                            <option value="">Select status</option>
                            <option *ngFor="let opt of passFailOptions" [value]="opt.value">{{ opt.label }}</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-6">
                    <div class="power-measurement-card">
                      <div class="power-card-header">
                        <i class="bi bi-shuffle text-warning"></i>
                        <h6 class="mb-0 fw-semibold">By-Pass Transfer</h6>
                      </div>
                      <div class="power-card-body">
                        <div class="d-flex align-items-center gap-3">
                          <label class="form-label text-muted mb-0 text-nowrap">Transfer to By-Pass using procedures:</label>
                          <select class="form-select power-select flex-grow-1" formControlName="transByPass">
                            <option value="">Select status</option>
                            <option *ngFor="let opt of passFailOptions" [value]="opt.value">{{ opt.label }}</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-6">
                    <div class="power-measurement-card">
                      <div class="power-card-header">
                        <i class="bi bi-activity text-success"></i>
                        <h6 class="mb-0 fw-semibold">Return to Normal</h6>
                      </div>
                      <div class="power-card-body">
                        <div class="d-flex align-items-center gap-3">
                          <label class="form-label text-muted mb-0 text-nowrap">STS from By-Pass to preferred source:</label>
                          <select class="form-select power-select flex-grow-1" formControlName="stsByPass">
                            <option value="">Select status</option>
                            <option *ngFor="let opt of passFailOptions" [value]="opt.value">{{ opt.label }}</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-6">
                    <div class="power-measurement-card">
                      <div class="power-card-header">
                        <i class="bi bi-exclamation-triangle text-danger"></i>
                        <h6 class="mb-0 fw-semibold">Active Alarms</h6>
                      </div>
                      <div class="power-card-body">
                        <div class="d-flex align-items-center gap-3">
                          <label class="form-label text-muted mb-0 text-nowrap">Verify any active alarms:</label>
                          <select class="form-select power-select flex-grow-1" formControlName="verifyAlarm">
                            <option value="">Select status</option>
                            <option *ngFor="let opt of passFailOptions" [value]="opt.value">{{ opt.label }}</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>

            </div>
          </div>
        </section>

        <section class="ups-readings-section">
          <div class="ups-section-card">
            
            <div class="ups-section-content show">
              
              <div class="d-flex justify-content-end mt-3 gap-2">
                <button class="btn btn-light-primary" type="button" (click)="saveAsDraft()" [disabled]="saving">
                  <span *ngIf="saving" class="spinner-border spinner-border-sm me-2"></span>
                  Save As Draft
                </button>
                <button class="btn btn-primary" type="button" (click)="saveSTS()" [disabled]="saving">
                  <span *ngIf="saving" class="spinner-border spinner-border-sm me-2"></span>
                  Save STS
                </button>
              </div>
            </div>
          </div>
        </section>

      </div>
    </div>
  </div>
</div>
