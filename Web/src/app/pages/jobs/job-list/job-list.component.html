<!-- begin::Header -->
<div class="table-container-width table-invisible">

  <div class="card">
    <div class="card-body border-0 pt-5">

      <form [formGroup]="jobFilterForm" novalidate="" class="form">
        <table>
          <tr>
            <td>
              <label class="min-w-100px me-5 fw-bold mb-1 fs-6">AM</label>
            </td>
            <td>
              <label class="min-w-100px me-5 fw-bold mb-1 fs-6">Status</label>
            </td>
            <td>
              <label class="min-w-100px me-5 fw-bold mb-1 fs-6">Year</label>
            </td>
            <td>
              <label class="min-w-100px me-5 fw-bold mb-1 fs-6">Month</label>
            </td>
            <td>
              <label class="min-w-100px me-5 fw-bold mb-1 fs-6">Job</label>
            </td>
            <td>
              <label class="min-w-100px me-5 fw-bold mb-1 fs-6">Job Type</label>
            </td>
            <td>
              <label class="min-w-100px me-5 fw-bold mb-1 fs-6">Service Type</label>
            </td>
            <td></td>
          </tr>
          <tr>
            <td>
              <select
                class="form-select form-select-solid fw-bold text-dark fs-6 me-5"
                data-kt-select2="true"
                data-placeholder="Select option"
                data-allow-clear="true"
                formControlName="ownerId"
                style="width:100px;padding:4px;"
              >
                <option class = "fw-bold text-dark me-5" value="All" selected>All</option>
                <option class = "fw-bold text-dark me-5" *ngFor="let mgr of accountManagers" [value]="mgr.empName">
                  {{mgr.empName}}
                </option>
              </select>
            </td>
            <td>
              <select
                class="form-select form-select-solid fw-bold text-dark fs-6 me-5"
                data-kt-select2="true"
                data-placeholder="Select option"
                data-allow-clear="true"
                formControlName="status"
                style="width:100px;padding: 4px;"
              >
              <option class = "fw-bold text-dark me-5" value="All">All</option>
              <option class = "fw-bold text-dark me-5" *ngFor="let status of jobStatus" [value]="status.statusCode">{{status.statusDesc}}</option>
            </select>
            </td>
            <td>
              <select
                class="form-select form-select-solid fw-bold text-dark fs-6 me-5"
                data-kt-select2="true"
                data-placeholder="Select option"
                data-allow-clear="true"
                style="width:100px;padding:4px;"
                formControlName="year"
               >
               <option class = "fw-bold text-dark me-5" value="All" selected>All</option>
                <option class = "fw-bold text-dark me-5" *ngFor="let year of fiscalYears" [value]="year">
                  {{year}}
                </option>
              </select>
            </td>
            <td>
              <select
                class="form-select form-select-solid fw-bold text-dark fs-6 me-5"
                data-kt-select2="true"
                data-placeholder="Select option"
                data-allow-clear="true"
                style="width:100px;padding: 4px;"
                formControlName="month"
               >
               <option class = "fw-bold text-dark me-5" value="All" selected>All</option>
                <option class = "fw-bold text-dark me-5" *ngFor = "let month of months" [value]="month.value">{{month.Text}}</option>
              </select>
            </td>
            <td>
              <div class="col-lg-12">
                <select
                  class="form-select form-select-solid fw-bold text-dark fs-6 me-5"
                  data-kt-select2="true"
                  data-placeholder="Select option"
                  data-allow-clear="true"
                  formControlName="type"
                  style="width:100px;padding: 4px;"
                  >
                  <option class = "fw-bold text-dark me-5" value="All" selected>All</option>
                  <option class = "fw-bold text-dark me-5" value="PD">Past Due</option>
                </select>
              </div>
            </td>
            <td>
              <div class="col-lg-12">
                <select
                  class="form-select form-select-solid fw-bold text-dark fs-6 me-5"
                  data-kt-select2="true"
                  data-placeholder="Select option"
                  data-allow-clear="true"
                  formControlName="jobType"
                  style="width:100px;padding: 4px;"
                  >
                  <!-- <option class = "fw-bold text-dark me-5" value="ALL" selected>All</option> -->
                  <option class = "fw-bold text-dark me-5" value="0">Active</option>
                  <option class = "fw-bold text-dark me-5" value="1">Archive</option>
                </select>
              </div>
            </td>
            <td>
              <div class="col-lg-12">
                <select
                  class="form-select form-select-solid fw-bold text-dark fs-6 me-5"
                  data-kt-select2="true"
                  data-placeholder="Select option"
                  data-allow-clear="true"
                  formControlName="serviceType"
                  style="width:100px;padding: 4px;"
                  >
                  <!-- <option class = "fw-bold text-dark me-5" value="ALL" selected>All</option> -->
                  <option class = "fw-bold text-dark me-5" value="">All</option>
                  <option class = "fw-bold text-dark me-5" value="MC">MC</option>
                  <option class = "fw-bold text-dark me-5" value="T&M">T&M</option>
                </select>
              </div>
            </td>
            <td>
              <div class="input-group fw-bold text-dark fs-6">
                <input type="text" class="form-control form-control-sm fw-bold text-dark fs-6" style="border-color: black;" placeholder="Search" formControlName="jobId" (keyup.enter)="SearchJobs()">
                <div class="input-group-append">
                  <button class="btn btn-primary me-3 btn-sm btn-search" type="button" (click)="SearchJobs()">
                    <i class="fa fa-search"></i>
                  </button>
                  <button type="button" class="btn btn-primary me-3 fs-6" (click)="openChangeStatusModal()" [disabled]="selectedJobIds.length <= 0">Change Status</button>
                  <button type="button" class="btn btn-primary me-3 fs-6" (click)="importQuotes()">Import Jobs</button>
                  <button type="button" class="btn btn-primary fs-6" (click)="exportToExcel()">Export to Excel</button>
      
                </div>
              </div>
            </td>
          </tr>
        </table>
      </form>
      </div>
  </div>
    <div class="card card-xxl-stretch">
      <!-- <div class="card-header border-0">
        <div style="text-align: right;"
          class="card-toolbar"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          data-bs-trigger="hover"
          title="Import Quotes"
        >
        <button type="button" class="btn btn-primary me-3 fs-6" (click)="openChangeStatusModal()" [disabled]="selectedJobIds.length <= 0">Change Status</button>
        <button type="button" class="btn btn-primary me-3 fs-6" (click)="importQuotes()">Import Jobs</button>
        <button type="button" class="btn btn-primary fs-6" (click)="exportToExcel()">Export to Excel</button>
      </div>
      </div> -->
    <div class="card-body py-3">
      <!-- begin::Table container -->
      <div class="table-max-height">
        <!-- begin::Table -->
        <table id="table-to-export" class="table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4" style="text-align: center;">
          <!-- begin::Table head -->
          <thead>
            <tr class="text-dark fw-bolder badge-light-primary  fs-6">
              <th class="min-w-100px text-hover-primary fs-6" (click)="sortTable('jobID')" style="cursor: pointer; padding-left: 1rem;">Job Id <i class="fa" [ngClass]="sortIcon('jobID')"></i></th>
              <th class="min-w-100px text-hover-primary fs-6" (click)="sortTable('custNmbr')" style="cursor: pointer;">Site Id <i class="fa" [ngClass]="sortIcon('custNmbr')"></i></th>
              <th class="min-w-150px text-hover-primary fs-6" (click)="sortTable('custName')" style="cursor: pointer;">Site Name <i class="fa" [ngClass]="sortIcon('custName')"></i></th>
              <th class="min-w-150px text-hover-primary fs-6" (click)="sortTable('contactName')" style="cursor: pointer;">Contact Name <i class="fa" [ngClass]="sortIcon('contactName')"></i></th>
              <th class="min-w-100px text-hover-primary fs-6" (click)="sortTable('status')" style="cursor: pointer;">Status <i class="fa" [ngClass]="sortIcon('status')"></i></th>
              <th class="min-w-150px text-hover-primary fs-6" (click)="sortTable('svcDescr')" style="cursor: pointer;">Job Type <i class="fa" [ngClass]="sortIcon('svcDescr')"></i></th>
              <th class="min-w-125px text-hover-primary fs-6" (click)="sortTable('jobType')" style="cursor: pointer;">Service Type <i class="fa" [ngClass]="sortIcon('jobType')"></i></th>
              <th class="min-w-150px text-hover-primary fs-6" (click)="sortTable('address')" style="cursor: pointer;">Street Address<i class="fa" [ngClass]="sortIcon('address')"></i></th>
              <th class="min-w-100px text-hover-primary fs-6" (click)="sortTable('city')" style="cursor: pointer;">City<i class="fa" [ngClass]="sortIcon('city')"></i></th>
              <th class="min-w-70px text-hover-primary fs-6" (click)="sortTable('state')" style="cursor: pointer;">State<i class="fa" [ngClass]="sortIcon('state')"></i></th>
              
              
              <th class="min-w-150px text-hover-primary fs-6" *ngIf="selectedOwnerId === 'All'" (click)="sortTable('accMgr')" style="cursor: pointer;">AM<i class="fa" [ngClass]="sortIcon('accMgr')"></i></th>
              <th class="min-w-150px text-hover-primary fs-6" (click)="sortTable('responseDate')" style="cursor: pointer;">Response Date<i class="fa" [ngClass]="sortIcon('responseDate')"></i></th>
              
              <th class="min-w-85px text-hover-primary fs-6" (click)="sortTable('originalAge')" style="cursor: pointer;">Age <i class="fa" [ngClass]="sortIcon('originalAge')"></i></th>
              
              <th class="min-w-50px" style="padding-right: 1rem;">Notes</th>
              <th class="min-w-50px" style="padding-right: 1rem;">Edit</th>
              <th class="min-w-50px">
                <input
                class="form-check-input widget-9-check"
                style="border:solid; border-color: lightblue; cursor: pointer;"
                type="checkbox"
                [checked]="selectedJobIds.length === jobList.length"
                (click)="selectAllRows($event)"
              />
              </th>
            </tr>

          </thead>
          <!-- end::Table head -->
          <!-- begin::Table body -->
          <tbody class="text-dark mb-1 fs-6" style="text-align: center; font-family: Roboto condensed;" *ngIf="jobList && jobList.length > 0">
            <ng-container *ngFor="let quotes of jobList; let i = index;">
              <tr [ngStyle]="{ 'background-color': isQuoteSelected(quotes) ? 'lightyellow' : 'inherit' }">
                <td style="padding-left: 1rem;">
                  <div style="float:left; display:flex;">
                    <!-- Toggle the expanded state for each job -->
                    <i (click)="openEquipementDetailModel(quotes.jobID)"
                       [ngClass]="isOpenEquipementDetailModel[quotes.jobID] ? 'fa fa-minus-square' : 'fa fa-plus-square'"
                       style="font-size: 19px; padding-right: 4px;cursor: pointer;">
                    </i>
                    <span (click)="openQuoteDetailsModal(quotes.jobID)" class="text-hover-primary fs-6" style="cursor: pointer;">
                      {{quotes.jobID}}
                    </span>
                  </div>




                </td>
                <td>
                  <span class="">
                    {{quotes.custNmbr}}
                  </span>
                </td>
                <td>
                  <span class="">
                    {{quotes.custName}}
                  </span>
                </td>
                <td>
                  <span class="">
                    {{quotes.contactName}}
                  </span>
                </td>
                <td class="" [style.backgroundColor]="getColorByStatus(quotes.status)"[style.color]="'white'">
                  <span>
                    {{quotes.status}}
                  </span>
                </td>
                <td>
                  <span class="">
                    {{quotes.svcDescr}}
                  </span>
                </td>
                <td>
                  <span class="">
                    {{quotes.jobType}}
                  </span>
                </td>
                <td>
                  <span class="">
                    {{ quotes.address.split(',')[0].trim() }}
                  </span>
                </td>
                <td>
                  <span class="">
                    {{quotes.city}}
                  </span>
                </td><td>
                  <span class="">
                    {{quotes.state}}
                  </span>
                </td>
                <td *ngIf="selectedOwnerId === 'All'">
                  <span class="">
                    {{quotes.accMgr}}
                  </span>
                </td>
                <td>
                  <span class="">
                    {{quotes.responseDate | date}}
                  </span>
                </td>
                
                <td>
                  <span class="">
                    {{quotes.originalAge}}
                  </span>
                </td>
                
                <td>
                  <i (click)="getNotes(quotes.jobID, quotes.custNmbr)"
                    class="fas fa-sticky-note"
                  ></i>
                </td>
                <td>
                  <i (click)="edit(quotes.rowIndex)"
                    class="fas fa-edit"
                  ></i>
                </td>
                <td>
                  <input
                  class="form-check-input widget-9-check"
                  style="border:solid; border-color: lightblue; cursor: pointer; height: 1.4rem; width: 1.4rem"
                  type="checkbox"
                  [checked]="selectedJobIds.includes(quotes.jobID)"
                  (click)="rowSelect(quotes)"
                      />
                </td>
              </tr>
              <ng-container *ngIf="isOpenEquipementDetailModel[quotes.jobID]">
                <tr>
                  <td colspan="100%">
                    <app-equipment-details [jobId]="quotes.jobID"></app-equipment-details>
                  </td>
                </tr>
              </ng-container>
            </ng-container>

          </tbody>
          <!-- end::Table body -->
        </table>
        <!-- end::Table -->
      </div>
      <!-- end::Table container -->
    </div>
    </div>


    <app-pagination *ngIf="jobList.length> 0" [pageNum] = "paginationObj.pageNumber" [pageSize] = "paginationObj.pageSize"
    [totalRecords] ="paginationObj.totalRecordsCount"  (updatePagination) = "updatePagination($event)">
    </app-pagination>
</div>

  <!-- begin::Body -->
